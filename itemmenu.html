<!DOCTYPE html>
<html lang="en">

<head>
  <title>情報管理ツール</title>
  <style>
    #body {
      margin: 1%;
      border: 8px solid rgb(0, 0, 0);
      text-align: center;
      height: 43em;
    }

    header {
      display: flex;
    }

    .menu {
      flex: 1;
      height: 1.5em;
      padding-top: 0.2em;
      margin-bottom: 0.5em;
      color: rgb(0, 0, 0);
      border: 0.1em solid rgb(30, 163, 180);
      font-size: 2em;
      font-weight: bold;
      font-family: serif;
      overflow: scroll;
      text-align: center;

      transition: 0.2s;
    }

    .menu:hover {
      color: #ff0000;
    }

    .button {
      display: inline-block;
      border-radius: 12%;
      font-size: 1.5em;
      text-align: center;
      cursor: pointer;
      padding: 0.25em 0.5em;
      background-color: #c70000;
      color: #ffffff;
      line-height: 1em;
      transition: .3s;
      box-shadow: 2px 2px 1px #666666;
      border: 2px solid #990000;
    }

    .button:hover {
      box-shadow: none;
      color: #c70000;
      background-color: #ffffff;
    }

    .content {
      height: 100%;
      overflow: scroll;
    }

    #mailList,
    #mail {
      height: 100%;
      margin: auto;
      padding: 0.5em;
      color: rgb(0, 0, 0);
      background-color: #ffffff;
      font-family: serif;
      overflow: scroll;
    }

    #mailList {
      flex: 1;
      border-right: 5px solid rgb(0, 0, 0);
    }

    #mail {
      flex: 2;
    }

    .mailTytle {
      font-size: 30px;
      height: 1.5em;
      margin: 0.1em;
      color: rgb(0, 0, 0);
      border: 2px solid;
      font-family: serif;
      overflow: hidden;
    }

    .mailBody {
      font-size: 20px;
    }

    .item {
      display: flex;
      height: 15em;
      border-bottom: 2px solid rgb(0, 0, 0);
      padding: 1em;
    }

    .person {
      display: flex;
      height: 15em;
      border-bottom: 2px solid rgb(0, 0, 0);
      padding: 1em;
    }





    .img {
      flex: 4;
      height: 100%;

    }


    .comment {
      flex: 6;
      height: 100%;
      text-align: left;
      padding: 1em;
      padding-left: 2em;
    }

    img {
      width: 100%;
      height: 100%;
      object-fit: contain;
    }
  </style>
  <script>
    "use strict;"

    const sectionCnt = 3;
    const mailAllCnt = 5;//暫定
    const personAllCnt = 5;//暫定
    const itemAllCnt = 9;//暫定


    function setStorage(key, value) {
      var item = localStorage.setItem(key, value);
      return localStorage;
    }
    function getStorage(key) {
      var value = localStorage.getItem(key);
      return value;
    }
    function deleteStorage(key) {
      localStorage.removeItem(key);
    }
    function getParam(key) {
      const params = new URL(window.location.href).searchParams;
      return params.get(key)
    }
    function hide(id) { const obj = document.getElementById(id); if (obj) { obj.style.display = "none"; } }
    function show(id) { const obj = document.getElementById(id); if (obj) { obj.style.display = "block"; } }
    function next(n) {
      for (let i = 1; i <= sectionCnt; i++) { if (i == n) { show("section" + i) } else { hide("section" + i) }; }
    }

    function nextPerson(n) {
      for (let i = 1; i <= n; i++) {
        show("person" + i)
      }
      for (let i = n + 1; i <= personAllCnt; i++) {
        hide("person" + i)
      }
    }
    function nextItem(n) {
      for (let i = 1; i <= n; i++) {
        show("item" + i)
      }
      for (let i = n + 1; i <= itemAllCnt; i++) {
        hide("item" + i)
      }
    }
    function nextMail(n) {
      for (let i = 1; i <= n; i++) {
        show("mail" + i)
      }
      for (let i = n + 1; i <= itemAllCnt; i++) {
        hide("mail" + i)
      }

      //要改良


    }
    function openMail(n) {
      for (let i = 1; i <= mailAllCnt; i++) {
        if (i == n) {
          show("sectionMail" + i)
        } else {
          hide("sectionMail" + i)
        };
      }
    }
    function renew() {

      let p = getStorage("person");
      if (!p) { p = 0 };
      nextPerson(Number(p));
      let i = getStorage("item");
      if (!i) { i = 0 };
      nextItem(Number(i));

      nextMail(3);
      openMail(0);
    }

    function showImg(e) {
      const img = e.currentTarget.childNodes[1]
      window.open(img.src, '_blank')
    }

    function onclickFunction(e) {
      const func = this.callFunc;
      const targetId = e.currentTarget.getAttribute("targetId");
      const n = targetId.substr(-1);
      const sec = document.getElementById(targetId);
      if (sec.style.display == "none") { func(n) } else { func(0) };
    }

    function setEvent(cl, eve, func, call) {
      const elements = document.getElementsByClassName(cl);
      for (el of elements) {

        el.addEventListener(eve, {
          handleEvent: func,
          callFunc: call
        });
      };
    }

    function onlF() {
      next(0);
      renew();
      setEvent("menu", "click", onclickFunction, next)
      setEvent("mailTytle", "click", onclickFunction, openMail)
      setEvent("img", "click", showImg)
    }

    window.onload = onlF


    window.addEventListener('beforeunload', function (e) {
      e.returnValue = '';
    }, false);

  </script>
</head>

<body>
  <div>
    <span style="font-size: 1em;font-weight: bold;">オンラインリアル脱出ゲーム『平安京からの脱出』</span>
    <span style="font-size: 2em;font-weight: bold;">情報管理ツール</span>
    <span style="float: right;"><button class="button" onclick="renew()">更新</button></span>
  </div>
  <div id="body">
    <header style="height: 4em;">
      <div class="menu" targetId=section1 style="background-color: #fbec99;">人物</div>
      <div class="menu" targetId=section2 style="background-color: #c5fb99;">アイテム</div>
      <div class="menu" targetId=section3 style="background-color: #99f4fb;">メール</div>
      <!--<div class="menu" style="background-color: #99fbcd;">記録画像</div>-->
      <!--<div class="menu" style="background-color: #fb99de;">メニュータブあああああああああああ</div>-->
    </header>
    <main style="height: 39em;">
      <section class="content" id="section1">
        <div style="height: 100%;">
          <div style="border-bottom: 2px solid rgb(0, 0, 0);height: 8%;">
            ゲーム内で遭遇した人物の情報が保管されています。<br>
            画像はクリックで拡大表示できます。
          </div>
          <div id="person1">
            <div class="person">
            <div class="img">
              <img src="enigma1_2.png" alt="謎1_2">
            </div>
            <div class="comment">
              なぞなぞなぞなぞなぞなぞなぞなぞ<br>
              なぞなぞなぞなぞ
            </div>
            </div>
          </div>

          
          
          
        </div>

      </section>
      <section class="content" id="section2">
        <div style="height: 100%;">
          <div style="border-bottom: 2px solid rgb(0, 0, 0);height: 8%;">
            ゲーム中に入手したアイテムや情報が保管されています。<br>
            画像はクリックで拡大表示できます。
          </div>
          <div id="item1">
            <div class="item">
            <div class="img">
              <img src="assets/images/nazo1-1.png" alt="謎1_1">
            </div>
            <div class="comment">
              なぞなぞなぞなぞなぞなぞなぞなぞ<br>
              なぞなぞなぞなぞ
            </div>
            </div>
          </div>


          <div id="item2">
            <div class="item">
            <div class="img">
              <img src="assets/images/nazo1-2.png" alt="謎1_2">
            </div>
            <div class="comment">
              なぞなぞなぞなぞなぞなぞなぞなぞ<br>
              なぞなぞなぞなぞ
            </div>
            </div>
          </div>
          <div id="item3">
            <div class="item">
            <div class="img">
              <img src="assets/images/kinko.png" alt="封印の箱">
            </div>
            <div class="comment">
              スマホを封印することができる不思議な箱。<br>
              かなり頑丈で、とても壊せそうにないらしい。
            </div>
            </div>
          </div>
          <div id="item4">
            <div class="item">
            <div class="img">
              <img src="assets/images/nazo2-0.png" alt="謎2_0">
            </div>
            <div class="comment">
              なぞなぞなぞなぞなぞなぞなぞなぞ<br>
              なぞなぞなぞなぞ
            </div>
            </div>
          </div>
          <div id="item5">
            <div class="item">
            <div class="img">
              <img src="assets/images/nazo2-1.png" alt="謎2_1">
            </div>
            <div class="comment">
              なぞなぞなぞなぞなぞなぞなぞなぞなぞなぞなぞなぞ
              なぞなぞなぞなぞなぞなぞなぞなぞなぞなぞなぞなぞ
              なぞなぞなぞなぞなぞなぞなぞなぞなぞなぞなぞなぞ
            </div>
            </div>
          </div>
          <div id="item6">
            <div class="item">
            <div class="img"><img src="assets/images/nazo2-2.png" alt="謎2_2"></div>
            <div class="comment">
              なぞなぞなぞなぞなぞなぞなぞなぞ<br>
              なぞなぞなぞなぞ
            </div>
            </div>
          </div>
          <div id="item7">
            <div class="item">
            <div class="img"><img src="assets/images/nazo2-3.png" alt="謎2_3"></div>
            <div class="comment">
              なぞなぞなぞなぞなぞなぞなぞなぞ<br>
              なぞなぞなぞなぞ
            </div>
            </div>
          </div>
          <div id="item8">
            <div class="item">
            <div class="img"><img src="assets/images/nazo2-4.png" alt="謎2_4"></div>
            <div class="comment">
              なぞなぞなぞなぞなぞなぞなぞなぞ<br>
              なぞなぞなぞなぞ
            </div>
            </div>
          </div>
          <div id="item9">
            <div class="item">
            <div class="img"><img src="assets/images/kagihakken.png" alt="封印の箱の鍵"></div>
            <div class="comment">
              封印の箱の鍵。<br>
              押し入れの奥に隠してあった。
            </div>
            </div>
          </div>






        </div>
      </section>
      <section class="content" id="section3">
        <div style="border-bottom: 2px solid rgb(0, 0, 0);height: 8%;">
          届いたメールが保管されています。<br>
          
        </div>
        <div style="display: flex;height: 89%;">
          <section id="mailList">
            <div class="mailTytle" id="mail1" targetId=sectionMail1>メール1通目</div>
            <div class="mailTytle" id="mail2" targetId=sectionMail2>メール2通目</div>
            <div class="mailTytle" id="mail3" targetId=sectionMail3>メール3通目</div>
            <div class="mailTytle" id="mail4" targetId=sectionMail4>メール4通目</div>
            <div class="mailTytle" id="mail5" targetId=sectionMail5>メール5通目</div>
            <div class="mailTytle" id="mail1" targetId=sectionMail1>メール1通目</div>
            <div class="mailTytle" id="mail2" targetId=sectionMail2>メール2通目</div>
            <div class="mailTytle" id="mail3" targetId=sectionMail3>メール3通目</div>
            <div class="mailTytle" id="mail4" targetId=sectionMail4>メール4通目</div>
            <div class="mailTytle" id="mail5" targetId=sectionMail5>メール5通目</div>
            <div class="mailTytle" id="mail1" targetId=sectionMail1>メール1通目</div>
            <div class="mailTytle" id="mail2" targetId=sectionMail2>メール2通目</div>
            <div class="mailTytle" id="mail3" targetId=sectionMail3>メール3通目</div>
            <div class="mailTytle" id="mail4" targetId=sectionMail4>メール4通目</div>
            <div class="mailTytle" id="mail5" targetId=sectionMail5>メール5通目</div>
          </section>
          <section id="mail">

            <section class="mailBody" id="sectionMail1">メール1</section>
            <section class="mailBody" id="sectionMail2">メール2</section>
            <section class="mailBody" id="sectionMail3">メール3</section>
            <section class="mailBody" id="sectionMail4">メール4</section>
            <section class="mailBody" id="sectionMail5">メール5</section>

          </section>
        </div>
      </section>
    </main>
  </div>
</body>

</html>
